# ============================================================================
# DJANGO CORE SETTINGS
# ============================================================================

# Secret Key - CHANGE THIS in production!
# Generate with: python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
SECRET_KEY="your-secret-key-here"

# Environment - Options: development, test, production
DJANGO_ENV="development"

# IMPORTANT: Do NOT set DJANGO_SETTINGS_MODULE in .env or .envrc
# - pytest automatically uses config.settings.test (from pyproject.toml)
# - Django uses config.settings which loads the correct settings based on DJANGO_ENV
# Setting it here will break pytest's test database configuration

# Debug Mode - MUST be False in production
DEBUG="True"

# Allowed Hosts - comma-separated list of domains/IPs
# Add your domain in production: "localhost,127.0.0.1,yourdomain.com"
ALLOWED_HOSTS="localhost,127.0.0.1,0.0.0.0"

# Internal IPs for Django Debug Toolbar (development only)
INTERNAL_IPS="127.0.0.1"

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# Database - AWS RDS PostgreSQL (Development)
# Option 1: DATABASE_URL (recommended) - Single connection string with SSL
DATABASE_URL="postgresql://postgres:your-password@your-rds-endpoint.ap-southeast-2.rds.amazonaws.com:5432/iso_standards?sslmode=require"

# Option 2: Individual database settings (alternative to DATABASE_URL)
DB_ENGINE="django.db.backends.postgresql"
DB_NAME="iso_standards"
DB_USER="postgres"
DB_PASSWORD="your-password-here"
DB_HOST="your-rds-endpoint.ap-southeast-2.rds.amazonaws.com"
DB_PORT="5432"

# Database Connection Pool (optional - improves performance)
# DB_CONN_MAX_AGE="600"  # Connection lifetime in seconds (0 = close after request)
# DB_CONN_HEALTH_CHECKS="True"  # Enable connection health checks

# Get y Backend
# Options:
# - django.core.mail.backends.console.EmailBackend (development - prints to console)
# - django.core.mail.backends.smtp.EmailBackend (production - sends real emails)
# - django.core.mail.backends.locmem.EmailBackend (testing - stores in memory)
EMAIL_BACKEND="django.core.mail.backends.console.EmailBackend"

# SMTP Settings (for production with EMAIL_BACKEND=smtp.EmailBackend)
EMAIL_HOST="smtp.gmail.com"  # Gmail, SendGrid, Mailgun, etc.
EM============================================================================
# SUPERUSER CONFIGURATION (Development Setup)
# ============================================================================

# Superuser credentials for initial setup (make createsuperuser uses these)
DJANGO_SUPERUSER_USERNAME="admin"
DJWARNING: Only enable these if you're serving your site exclusively over HTTPS
# Read about HSTS: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security

# SSL/HTTPS Settings
SECURE_SSL_REDIRECT="False"  # Redirect all HTTP to HTTPS (production: True)
SECURE_PROXY_SSL_HEADER="False"  # Trust X-Forwarded-Proto header from proxy

# HSTS (HTTP Strict Transport Security)
SECURE_HSTS_SECONDS="0"  # Production: 31536000 (1 year), then consider 63072000 (2 years)
SECURE_HSTS_INCLUDE_SUBDOMAINS="False"  # Production: True
SECURE_HSTS_PRELOAD="False"  # Production: True (after HSTS is working)

# Cookie Security
SESSION_COOKIE_SECURE="False"  # Production: True (requires HTTPS)
SESSION_COOKIE_HTTPONLY="True"  # Prevent JavaScript access to session cookie
SESSION_COOKIE_SAMESITE="Lax"  # Options: Strict, Lax, None
SESSION_COOKIE_AGE="1209600"  # 2 weeks in seconds

CSRF_COOKIE_SECURE="False"  # Production: True (requires HTTPS)
CSRF_COOKIE_HTTPONLY="True"  # Prevent JavaScript access to CSRF cookie
CSRF_COOKIE_SAMESITE="Lax"

# Content Security
SECURE_CONTENT_TYPE_NOSNIFF="True"  # Prevent MIME-sniffing
SECURE_BROWSER_XSS_FILTER="True"  # Enable XSS filter
X_FRAME_OPTIONS="DENY"  # Options: DENY, SAMEORIGIN, ALLOW-FROM uri

# ============================================================================
# PERFORMANCE & OPTIMIZATION
# ============================================================================

# Template caching (production only)
# TEMPLATE_CACHE="True"

# Static files compression (with WhiteNoise)
# WHITENOISE_COMPRESS="True"
# WHITENOISE_AUTOREFRESH="False"  # Set to True in development for auto-reload

# ============================================================================
# THIRD-PARTY SERVICES (Optional)
# ============================================================================

# Sentry (Error Tracking) - Uncomment to enable
# SENTRY_DSN=""
# SENTRY_ENVIRONMENT="development"
# SENTRY_TRACES_SAMPLE_RATE="0.1"

# Google Analytics
# GA_TRACKING_ID=""

# Stripe (Payment Processing)
# STRIPE_PUBLIC_KEY=""
# STRIPE_SECRET_KEY=""
# STRIPE_WEBHOOK_SECRET=""

# ============================================================================
# FEATURE FLAGS (Optional)
# ============================================================================

# Enable/disable features without code changes
# FEATURE_REGISTRATION_ENABLED="True"
# FEATURE_API_V2_ENABLED="False"
# FEATURE_MAINTENANCE_MODE="False"

# ============================================================================
# NOTES FOR DEVELOPERS
# ============================================================================

# Quick Start:
# 1. Copy this file: cp .env.example .env
# 2. Update SECRET_KEY with a new random key
# 3. Update DATABASE_URL with your database credentials
# 4. Update email settings if testing email functionality
# 5. Run: python manage.py migrate
# 6. Run: python manage.py createsuperuser (or make superuser)
# 7. Run: python manage.py runserver

# Useful Commands:
# - Generate SECRET_KEY: python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
# - Check environment: python manage.py check --deploy
# - Run tests: pytest
# - Create superuser: python manage.py createsuperuser
# - Collect static: python manage.py collectstatic
# - Make migrations: python manage.py makemigrations
# - Apply migrations: python manage.py migrate

# Environment Detection:
# - development: DEBUG=True, console email, local database
# - test: pytest uses SQLite in-memory, no emails sent
# - production: DEBUG=False, HTTPS required, real database, email via SMTP
# AWS_SECRET_ACCESS_KEY=""
# AWS_STORAGE_BUCKET_NAME=""
# AWS_S3_REGION_NAME="ap-southeast-2"
# AWS_S3_CUSTOM_DOMAIN=""
# AWS_DEFAULT_ACL="public-read"

# Static/Media files on S3 (uncomment to enable)
# USE_S3_STATIC="False"
# USE_S3_MEDIA="False"

# ============================================================================
# CORS & API CONFIGURATION (Frontend Integration)
# ============================================================================

# CORS - Allow frontend to make API requests
CORS_ALLOWED_ORIGINS="http://localhost:3000,http://localhost:5173,http://127.0.0.1:5173"
CORS_ALLOW_CREDENTIALS="True"

# CSRF Trusted Origins (for POST requests from frontend)
CSRF_TRUSTED_ORIGINS="http://localhost:3000,http://localhost:5173,http://127.0.0.1:5173"

# API Rate Limiting (requests per minute)
# API_RATE_LIMIT="100/min"

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log Level - Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL="INFO"

# Log to file (uncomment to enable file logging)
# LOG_TO_FILE="True"
# LOG_FILE_PATH="logs/django.log"

# ============================================================================
# DEVELOPMENT TOOLS
# ============================================================================

# Django Debug Toolbar (automatically enabled in development if installed)
DEBUG_TOOLBAR_ENABLED="True"

# Django Extensions (shell_plus, runserver_plus, etc.)
# SHELL_PLUS_PRINT_SQL="True"

# ============================================================================
# SECURITY SETTINGS (Production)
# ============================================================================
# Email Addresses
DEFAULT_FROM_EMAIL="noreply@yourdomain.com"
SERVER_EMAIL="server@yourdomain.com"  # For error emails
ADMINS_EMAIL="admin@yourdomain.com"  # Comma-separated for multiple

# Email for local development
# For Gmail: https://support.google.com/accounts/answer/185833 (App Passwords)
# For SendGrid: https://sendgrid.com/
# For Mailgun: https://www.mailgun.com/===========================================
# CACHE CONFIGURATION (Optional - Redis recommended for production)
# ============================================================================

# Redis Cache (uncomment to enable)
# REDIS_URL="redis://localhost:6379/1"
# CACHE_BACKEND="django.core.cache.backends.redis.RedisCache"
# CACHE_LOCATION="redis://127.0.0.1:6379/1"

# Session Cache (uncomment to use Redis for sessions)
# SESSION_ENGINE="django.contrib.sessions.backends.cache"
# SESSION_CACHE_ALIAS="default"

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================

# Email
EMAIL_BACKEND="django.core.mail.backends.console.EmailBackend"
EMAIL_HOST=""
EMAIL_PORT="587"
EMAIL_USE_TLS="True"
EMAIL_HOST_USER=""
EMAIL_HOST_PASSWORD=""
DEFAULT_FROM_EMAIL="root@localhost"

# Superuser (for development)
DJANGO_SUPERUSER_USERNAME="admin"
DJANGO_SUPERUSER_EMAIL="admin@example.com"
DJANGO_SUPERUSER_PASSWORD="changeme"


# Security (Production only)
# WARNING: Only enable these if you're serving your site exclusively over HTTPS
# Read about HSTS before enabling: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
SECURE_SSL_REDIRECT="False"
SECURE_HSTS_SECONDS="0"  # Set to 31536000 (1 year) for production with HTTPS
SECURE_HSTS_INCLUDE_SUBDOMAINS="False"
SECURE_HSTS_PRELOAD="False"
SESSION_COOKIE_SECURE="False"
CSRF_COOKIE_SECURE="False"
